#!/bin/bash

if [ "$1" == "" ]; then
 echo "usage: $0 file"
 exit 1
fi

if [ "$2" == "" ]; then
  COUNT=-1
else
  COUNT=$2
fi

if [ "$3" == "" ]; then
  SKIP=0
else
  SKIP=$3
fi

#PERL="/usr/bin/perl -d:NYTProf"
PERL="/usr/bin/perl"
CATMANDU=${HOME}/Dev/perl/Catmandu
PROJ=${CATMANDU}/examples/aleph

${PERL} ${CATMANDU}/bin/catmandu index -v \
     -T Solr -t id_field=fSYS \
     -S Catmandu::Importer::Aleph -s map=${PROJ}/data/aleph.map -s file=$1 -s count=$COUNT -s skip=$SKIP \
     --fix=${PROJ}/data/aleph.fix 
