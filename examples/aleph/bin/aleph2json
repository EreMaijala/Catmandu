#!/bin/bash

PERL="/usr/bin/perl"
CATMANDU=${HOME}/Dev/perl/Catmandu
PROJ=${CATMANDU}/examples/aleph

if [ "$1" == "" -o "$2" == "" ]; then
 echo "usage: $0 file type"
 exit 1
fi

TYPE_FIX=""

if [ -r ${PROJ}/data/${2}.fix ]; then
 TYPE_FIX="--fix=${PROJ}/data/${2}.fix"
else
 echo "failed to read =${PROJ}/data/${TYPE}.fix"
 exit 2
fi

zcat $1 | \
${PERL} ${CATMANDU}/bin/catmandu convert \
     -I Aleph -i map=${PROJ}/data/aleph.map  \
     ${TYPE_FIX} \
     --pretty /dev/stdin
